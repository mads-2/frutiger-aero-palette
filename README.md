# Frutiger Aero — Analysis + Dashboard (bios611project)

## For Creatives (People Using the Dashboard for Inspiration)

This project provides an interactive exploration of the Frutiger Aero aesthetic through 3D color maps, semantic embeddings, and a visual dashboard. No technical background is required.

Repository URL:  
https://github.com/mads-2/bios611project

---

### 1. Clone the Repository

```bash
git clone https://github.com/mads-2/bios611project
cd bios611project
```

---

### 2. Build the Dashboard Environment

```bash
docker build . -t aero
```

---

### 3. Run the Dashboard

```bash
docker run --rm     -e PASSWORD=mysecret     -p 8181:8181     -p 8787:8787     -v "$(pwd)":/home/rstudio/project     aero
```

Once it starts:

- **RStudio:** http://localhost:8787  
  username: `rstudio`, password: `mysecret`
- **Dashboard:** http://localhost:8181 (after pipeline builds)

---

### 4. Build Everything

Inside the RStudio terminal:

```bash
make all
```

This automatically:

- Regenerates all color files  
- Aggregates Google Vision object metadata  
- Creates 3D color plots  
- Generates t-SNE embeddings  
- Builds random embedding plots  
- Launches the interactive dashboard  

---

# For Developers  
## (Adding New Data, Using the Vision API Tools, or Extending the Pipeline)

This section provides detailed instructions for adding images, generating objects, embeddings, and understanding the workflow.

---

## Required Directory Structure

```
images/
    FA_<style>/
        001.png
        001colors.txt
        001object.txt
        object_instances.txt
        vectors_object_instances.txt
```

Each image must follow the naming rules described below.

---

## Image Naming Rules (Very Important)

### Each image must follow:

```
<NUMBER>.png
```

Example:

```
001.png
002.png
003.png
```

### Matching files generated during the pipeline:

- **<NUMBER>colors.txt** — automatically created during `make colors`
- **<NUMBER>object.txt** — generated by Google Vision API scripts
- These must share the same number:

```
001.png
001colors.txt
001object.txt
```

If the numbering does not match, the Makefile will abort.

---

## How Colors Are Generated

You do **not** need to create any color files manually.

The Makefile runs:

- `colors/extract_all_FA.R`
- `colors/aggregate_FA_colors.R`

These:

- Remove any old color files  
- Extract dominant colors from each PNG  
- Save them as:

```
<NUMBER>colors.txt
colors.txt (combined summary)
```

Running:

```bash
make colors
```

regenerates **all** color data.

---

## How Objects Are Generated (Google Vision API)

Each image requires a matching:

```
<NUMBER>object.txt
```

These are generated using **your existing Python tools**, located in:

```
/objects/
```

Specifically:

### 1. Google Vision label detection  
- Script: `FA_google_vision.py`  
- Loads the API key from:  
  `GOOGLE_VISION_API_KEY`
- Produces:

```
001object.txt
002object.txt
...
```

### 2. Aggregation of object files  
`aggregate_FA_objects.R` combines all `*object.txt` files into:

```
object_instances.txt
```

This file is required before embedding.

---

## How to Generate Embeddings (Google Vertex AI)

You already have two scripts:

### • `test_DORFic_vectors.py`
Processes a single style folder (FA_DORFic).

### • `all_non_DORFic_vectors.py`
Processes all other FA_* folders at once.

These produce:

```
vectors_object_instances.txt
```

These scripts use:

- Google Vertex AI text-embedding-005 model  
- Authentication via `gcloud auth print-access-token`  
- CURL requests to the Vertex API endpoint  

To generate embeddings for new objects, developers **must**:

### Obtain:
- A Google Cloud account  
- Vertex AI enabled  
- Vision API enabled  
- A valid GCP project and authentication  

---

## Adding New Images (Full Workflow)

1. Place new PNGs into the correct folder:

```
images/FA_<style>/
```

2. Ensure each file has the correct numbering:

```
<NUMBER>.png
```

3. Generate object detection files:

```
python objects/FA_google_vision.py
```

This creates:

```
<NUMBER>object.txt
```

4. Aggregate objects:

```
Rscript objects/aggregate_FA_objects.R
```

This builds:

```
object_instances.txt
```

5. Generate embeddings:

```
python objects/all_non_DORFic_vectors.py
```

(or use the DORFic script for FA_DORFic)

6. Run the full dashboard pipeline:

```
make all
```

---

## Key Make Targets

```
make all               # Full pipeline (recommended)
make dashboard         # Same as make all
make colors            # Rebuild color files
make objects           # Aggregate object.txt files
make embeddings        # Build t-SNE embeddings
make random-embeddings # Build random embedding baseline
make colors-plot       # Generate 3D color plot
make clean             # Remove generated files
make build             # Build Docker image
make run               # Run RStudio + dashboard
make stop              # Stop containers
```

---

This README explains the full workflow for both creatives and developers.

